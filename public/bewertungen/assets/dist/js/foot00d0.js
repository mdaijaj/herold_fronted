!function(){function e(e,t,i,a){if("undefined"!=typeof dataLayer_tracking){var n={Kategorie:e,Action:t,event:"genericEvent"};i&&0!==i.length&&(n.Label=i),a&&0!==a.length&&(n.Wert=a),dataLayer.push(n)}}function t(e){$.ajax({url:baseUrlReview+"/newReview.do?sid="+$.trim(e)+"&provider=HEROLD",success:function(e){$("#rate_company ol li").eq(1).removeClass("disabled").find("a").click(),$("#navStep1").addClass("disabled"),$("#navStep2").removeClass("disabled"),$("#wrap1").addClass("hidden"),$("#wrap2").removeClass("hidden").html(e),a()}})}function a(){var t=$("#ratingSummary");t.on("rating",(function(){var e=0,t=0,a=0,n="0 Sterne",r=[];for($("#rating_fields").find('input[type="hidden"]').each((function(){var e=parseInt($(this).val());e>0&&r.push(e)})),r.length>0&&(e=r.reduce((function(e,t){return e+t}),0),t=Math.round(e/r.length),n=(a=Math.round(e/r.length*10)/10).toString().replace(".",",")+'<span class="d-none d-md-inline"> '+(a>1?"Sterne":"Stern")+"</span>"),$("#ratingSummary .ratingText").html(n),i=1;i<=5;i++)i<=t?$(".star-rating-total .icon-star:nth-child("+i+")").addClass("active"):$(".star-rating-total .icon-star:nth-child("+i+")").removeClass("active")})),$("div.star-rating").on("click","input",(function(){var e=$(this),i=e.closest(".rating"),a=e.val();i.find('input[type="hidden"]').eq(0).val(a),i.find(".ratinglabel").text($("label[for='"+e.attr("id")+"']").attr("title")),i.find('input[type="checkbox"]').attr("checked",!1),i.find(".ratingText").css("visibility","visible"),i.find(".norating").css("visibility","visible"),t.trigger("rating")})),$(".norating").on("click",(function(){var e=$(this),i=e.closest(".rating"),a=i.find(".ratingText"),n=e.closest(".norating");a.css("visibility","hidden"),n.css("visibility","hidden"),i.find('input[type="hidden"]').eq(0).val(""),i.find(".ratinglabel").text(""),i.find('input[type="radio"]').prop("checked",!1),t.trigger("rating")})),$(".rating").each((function(){var e=$(this),t=parseInt(e.find("input").val());t>0?e.find(".star-"+t).trigger("click"):e.find('input[type="checkbox"]').attr("checked",!0)})),$(".row.reviewInput").each((function(){var e=$(this),t=$(),i=e.find(".icon-ok"),a=!1;e.find('input[type="text"]').length?(t=e.find('input[type="text"]'),a=!0):e.find("textarea").length?(t=e.find("textarea"),a=!0):t=e.find('input[type="radio"]'),a?t.on("input",(function(){t.val().length>=t.data("minlength")?i.css("display","block"):i.css("display","none")})):t.on("change",(function(){i.css("display","block")}))})),$('a[id^="recommended_btn"]').on("click",(function(){var e=$("#"+$(this).data("tie"));$('a[id^="recommended_btn"]').removeClass("blue").addClass("white"),$(this).removeClass("white").addClass("blue"),e.click()})),$(".button-submit").one("click",(function(){$(this).closest("form").submit()})),$("#rating-form").validate({messagePosition:"bottom"}).ajaxForm({cache:!1,contentType:"text/html",Accept:"text/html",beforeSubmit:function(e,t){var i=$("#btn-submit-review");if(i.data("requestRunning"))alert("Eine weitere bewertung wurde abgegeben, bitte warten ...");else{if(i.attr("disabled",!0),i.data("requestRunning",!0),$("#agbaccepted").length&&!$("#agbaccepted").is(":checked"))return alert("Bitte akzeptieren Sie die Bewertungsrichtlinien!"),i.removeAttr("disabled"),i.data("requestRunning",!1),!1;t.find("p.status").removeClass("error success").addClass("loading").text("Ihre Bewertung wird geprüft...")}},success:function(t,i,a,n){e("Review","save","YP:"+n.find('input[name="sid"]').val()),n.find("p.status").removeClass("error loading").addClass("success").text(""),n.data("validate").parseResponse(t);var r=1==$("#lotteryParticipation").prop("checked"),s=baseUrlReview+"/admin/saveTempReview.do?publicKey="+t.REVUserReview.publicKey+"&followCompany=false&lottery="+r,o=baseUrlReview+"/saveTempGuestReview.do?publicKey="+t.REVUserReview.publicKey+"&followCompany=false&lottery="+r,l=(baseUrlReview,t.REVUserReview.publicKey,huiDirectLoginUrl,""),d="";"guest"==$("#rating-form").data("submitMode")?(l=huiDirectLoginFrameUrlGuestTab+"&redirectUrl="+s+"&referrer="+s+"&guestReferrer="+o,$("#rating-form").removeData("submitMode")):"register"==$("#rating-form").data("submitMode")?(d=huiDirectRegisterUrl+"?referrer="+s,$("#rating-form").removeData("submitMode")):l=huiDirectLoginFrameUrl+"&redirectUrl="+s+"&referrer="+s+"&guestReferrer="+o,isLoggedIn?window.location.href=s:""!==d?window.location.href=d:($("#loginModal").modal("show"),$("#externalLoginIFrame").attr("src",l)),$("#btn-submit-review").data("requestRunning",!1)},error:function(e,t,i,a){var n=$.parseJSON(e.responseText),r="Bitte korrigieren Sie die Eingabefehler!";n.REVResponse.hasOwnProperty("errors")&&n.REVResponse.errors.hasOwnProperty("captcha")&&(r="Bitte l�sen Sie das Captcha!"),a.find("p.status").removeClass("loading success").addClass("error").text(r),a.data("validate").parseResponse(e.responseJSON),e.responseJSON.REVResponse.generalError&&alert(e.responseJSON.REVResponse.generalError),$(".button-submit").one("click",(function(){$(this).closest("form").submit()}));var s=$("#btn-submit-review");s.attr("disabled",!1),s.data("requestRunning",!1)}}),$("#youTubeUrl").blur((function(){var e=$(this),t=e.parent().find(".validate-pos");$.ajax({url:baseUrlReview+"/validateYouTubeURL.json",dataType:"json",data:{youTubeUrl:$("#youTubeUrl").val()},type:"POST",success:function(i){e.removeClass("validate-error"),t.html(""),$("#youTubeUrl").parent().find(".iframe").remove(),$("#youTubeUrl").after('<div class="iframe" style="margin-top:10px"><p>Vorschau des Youtube-Videos</p><iframe style="margin: 10px auto 0 auto;display: block" class="youtube-player"  src="'+i.youtubeBaseUrl+"embed/"+i.videoID+'" allowfullscreen frameborder="0" width="640" height="385"></iframe></div>')},error:function(i){$("#youTubeUrl").parent().find(".iframe").remove(),e.addClass("validate-error"),t.html('<div class="validate-msg-up yt-error"><div class="arrow arrow-up"></div><div class="inner">'+i.responseJSON.REVResponse.errors.youTubeUrl+"</div></div></div>")}})}))}$((function(){var i,a;$("[data-action]").on("click",(function(){var t=$(this);e(t.data("category"),t.data("action"),t.data("label"),t.data("value"))})),$(".showPhone.overlapping").length&&$(".showPhone").on("click",(function(e){$(this).addClass("overlapped").removeClass("overlapping"),$(this).prev().addClass("overlapping").removeClass("overlapped")})),$(".showPhone.switch").length&&$(".showPhone").on("click",(function(e){$(this).next().removeClass("hidden"),$(this).remove()})),$("#carousel-review").carousel(),$("#companiesSearch").length>0&&(i=$("#changeCompanyForm"),a=$("#companiesSearch"),i.ajaxForm({beforeSerialize:function(e,i){var n=a.val();return $.isNumeric(n)?t(n):t($("#companySID")[0].value),!1}}),a.on("click",(function(){$(this).select()})).autocomplete({minLength:3,source:function(e,t){$.ajax({url:baseUrlReview+"/searchCompanies.json",dataType:"json",data:{maxResults:10,language:0,name:e.term},success:function(e){t($.map(e.companies,(function(e){return{companyName:e.companyName,companySid:e.companySid,street:e.street,houseNo:e.houseNo,city:e.city,zip:e.zip,value:e.companyName}})))}})},select:function(e,i){return $("#companySID")[0].value=i.item.companySid,t(i.item.companySid),!1},focus:function(e,t){return $("#companySID")[0].value=t.item.companySid,t.item.companyName}}).data("uiAutocomplete")._renderItem=function(e,t){var i=t.zip+" "+t.city;if(null!=t.street&&""!=t.street){var a=t.street;null!=t.houseNo&&""!=t.houseNo&&(a=a+" "+t.houseNo),i=i+", "+a}return $("<li/>").data("item.autocomplete",t).append("<a>"+t.companyName+'<div class="infoAutosuggest">'+i+" </div></a>").appendTo(e)}),$("select.region-filter").on("change",(function(){$(this).find(":selected").data("link")&&(window.location.href=$(this).find(":selected").data("link"))})),$(".convert-emoji").each((function(){var e=$(this).html(),t=emojione.unicodeToImage(e);$(this).html(t)}))})),window.hbdTrackEvent=e,window.setGuestMode=function(){$("#rating-form").data("submitMode","guest")},window.setRegisterMode=function(){$("#rating-form").data("submitMode","register")},window.hbdTrackEvent=e,window.reviewFunctions=a}();
//# sourceMappingURL=foot.js.map