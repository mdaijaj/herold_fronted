!function(){"use strict";var e=window.matchMedia("(max-width: 767px)"),t={boundsOfAT:[[9.4,49],[17.15,46.4]],layers:[{active:!0,name:"Karte",style:"mapbox://styles/mapbox/streets-v10",selected:!0},{active:!0,name:"Hybrid",style:"mapbox://styles/mapbox/satellite-streets-v9",selected:!1},{active:!0,name:"Luftbilder",style:"mapbox://styles/mapbox/satellite-v9",selected:!1}],basic:{style:"mapbox://styles/mapbox/streets-v10",iconPosition:"bottom-right",dragRotate:!1,dragPan:!0,touchZoomRotate:!0,trackResize:!0,attributionControl:!1,padding:{top:40,right:50,bottom:20,left:20},animateDuration:300,animateSpeed:2,maxZoom:18},resultList:{container:"mainMap",zoom:14.5,padding:{top:40,right:50,bottom:20,left:20},interactive:!0},overlay:{container:"overlayMap",zoom:14.5,padding:{top:40,right:50,bottom:20,left:20},interactive:!0,scrollZoom:!0},iframe:{container:"map",zoom:12,padding:{top:20,right:20,bottom:20,left:20},interactive:!0},route:{container:"map",zoom:14.5,padding:{top:50,right:100,bottom:10,left:520},interactive:!0,scrollZoom:!0}},i={tl:"top-left",tr:"top-right",bl:"bottom-left",br:"bottom-right"};function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var o=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,"hbdmap",void 0),a(this,"_map",void 0),a(this,"_container",void 0),a(this,"_popup",void 0),this.hbdmap=e}var i,o;return i=t,(o=[{key:"onAdd",value:function(t){return this._map=t,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl mapboxgl-ctrl-group toGroup d-block",this._container.appendChild(this.createPopup()),this._container.appendChild(this.createButton()),e.matches||(this._container.addEventListener("mouseenter",(function(e){e.target.parentNode.querySelector("#poiList").classList.toggle("hidden")})),this._container.addEventListener("mouseleave",(function(e){e.target.parentNode.querySelector("#poiList").classList.toggle("hidden")}))),this._container}},{key:"onRemove",value:function(){this._container.parentNode.removeChild(this._container),this._map=void 0}},{key:"hideMe",value:function(){this._popup.classList.add("hidden")}},{key:"createPopup",value:function(){var e=this;this._popup=document.createElement("div"),this._popup.setAttribute("id","poiList"),this._popup.className="mapControlPopup hidden";var t=document.createElement("ul");return t.className="row inner",this.hbdmap.poiconfig.forEach((function(i){if(!i.hidden){var n=document.createElement("li");n.className="col-24"+(i.defaultsel?" selected":""),n.setAttribute("data-value",i.id);var a=document.createElement("span");a.innerHTML=i.label,n.appendChild(a),t.appendChild(n),n.addEventListener("click",(function(t){var i;i="LI"==t.target.tagName.toUpperCase()?t.target:t.target.parentNode;var n=$(i).find("i");i.classList.contains("selected")?(n.removeClass("icon-check"),n.addClass("icon-check-empty")):(n.removeClass("icon-check-empty"),n.addClass("icon-check")),$(i).toggleClass("selected"),e.hbdmap.poiconfig.forEach((function(e){e.id==i.dataset.value&&(e.defaultsel=i.classList.contains("selected"))})),e.hbdmap.getPOIs("route")}))}})),this._popup.appendChild(t),this._popup}},{key:"createButton",value:function(){var t=document.createElement("button");return t.className="mapboxgl-ctrl-icon mapboxgl-ctrl-poiView",t.setAttribute("type","button"),t.setAttribute("title","Anzeige der POI ändern"),t.setAttribute("aria-label","Anzeige der POI ändern"),e.matches&&t.addEventListener("touchend",(function(e){e.target.parentNode.querySelector("#poiList").classList.toggle("hidden"),e.target.parentNode.querySelector("#styleList").classList.add("hidden")})),t}}])&&n(i.prototype,o),t}();function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var l=function(){function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),s(this,"_map",void 0),s(this,"_container",void 0),s(this,"_popup",void 0)}var n,a;return n=i,(a=[{key:"onAdd",value:function(t){return this._map=t,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl mapboxgl-ctrl-group d-block",this._container.appendChild(this.createPopup()),this._container.appendChild(this.createButton()),e.matches||(this._container.addEventListener("mouseenter",(function(e){e.target.parentNode.querySelector("#styleList").classList.toggle("hidden")})),this._container.addEventListener("mouseleave",(function(e){e.target.parentNode.querySelector("#styleList").classList.toggle("hidden")}))),this._container}},{key:"onRemove",value:function(){this._container.parentNode.removeChild(this._container),this._map=void 0}},{key:"hideMe",value:function(){this._popup.classList.add("hidden")}},{key:"createPopup",value:function(){var e=this;this._popup=document.createElement("div"),this._popup.setAttribute("id","styleList"),this._popup.className="mapControlPopup hidden";var i=document.createElement("ul");return i.className="row inner",t.layers.forEach((function(t){var n=document.createElement("li");n.className="col-24"+(t.selected?" selected":""),n.setAttribute("data-value",t.name.toLowerCase()),n.setAttribute("data-style",t.style);var a=document.createElement("span");a.innerHTML=t.name,n.appendChild(a),i.appendChild(n),n.addEventListener("click",(function(t){var i;i="LI"==t.target.tagName.toUpperCase()?t.target:t.target.parentNode,e._map.setStyle($(i).data("style"));var n=new MapboxLanguage({defaultLanguage:"de"});e._map.addControl(n),$("#styleList .selected").removeClass("selected"),$(i).addClass("selected"),$("#styleList .icon-ok").removeClass("icon-ok").addClass("icon-missing"),$(i).find("i").removeClass("icon-missing").addClass("icon-ok")}))})),this._popup.appendChild(i),this._popup}},{key:"createButton",value:function(){var t=document.createElement("button");return t.className="mapboxgl-ctrl-icon mapboxgl-ctrl-styles",t.setAttribute("type","button"),t.setAttribute("title","Ansicht ändern"),t.setAttribute("aria-label","Ansicht ändern"),e.matches&&t.addEventListener("touchend",(function(e){e.target.parentNode.querySelector("#styleList").classList.toggle("hidden"),e.target.parentNode.querySelector("#poiList")&&e.target.parentNode.querySelector("#poiList").classList.add("hidden")})),t}}])&&r(n.prototype,a),i}();function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var p=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),u(this,"center",[]),u(this,"geometry",{coordinates:[],type:""}),u(this,"properties",{id:"",symbol:""}),u(this,"place_name","")}return t=e,(i=[{key:"setCoordinates",value:function(e){return this.center=e,this.geometry={},this.geometry.type="Point",this.geometry.coordinates=e,this}},{key:"setId",value:function(e){return this.properties.id=e,this.properties.symbol="pin"+e,this}},{key:"setName",value:function(e){return this.place_name=e,this}},{key:"build",value:function(){return this}}])&&c(t.prototype,i),n&&c(t,n),e;var t,i,n}();function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"_map",void 0),h(this,"_container",void 0),h(this,"hbdmap",void 0),h(this,"locationHTML",'<button class="mapboxgl-ctrl-icon mapboxgl-ctrl-location" type="button" title="Mein Standort" aria-label="Mein Standort"></button>'),this.hbdmap=t}var i,n;return i=e,(n=[{key:"onAdd",value:function(e){var t=this;return this._map=e,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl mapboxgl-ctrl-group toGroup d-block",this._container.innerHTML=this.locationHTML,this._container.addEventListener("click",(function(){t.getLocation()})),this._container}},{key:"onRemove",value:function(){this._container.parentNode.removeChild(this._container),this._map=void 0}},{key:"getLocation",value:function(){var e=this,i=[];this.hbdmap.myLocation?this.hbdmap.flyMeTo(this.hbdmap.myLocation.geometry.coordinates,null,5,t[this.hbdmap.type].zoom):navigator.geolocation?navigator.geolocation.getCurrentPosition((function(n){i=[n.coords.longitude,n.coords.latitude],e.hbdmap.myLocation=(new p).setId("MyLocation").setName("Mein Standort").setCoordinates(i).build(),e.hbdmap.checkPredefinedPoints()||(e.hbdmap.setPin("location",e.hbdmap.myLocation,!1),e.hbdmap.flyMeTo(i,null,5,t[e.hbdmap.type].zoom)),"function"==typeof e.hbdmap.checkRouteComplete&&e.hbdmap.checkRouteComplete()}),(function(t){console.log(t.message),$(".mapboxgl-ctrl-location").parent().remove(),e.hbdmap.checkPredefinedPoints()})):(console.log("Geolocation is not supported by this browser."),$(".mapboxgl-ctrl-location").parent().remove(),this.hbdmap.checkPredefinedPoints())}}])&&d(i.prototype,n),e}();function f(e,t,i,n,a){var o={Kategorie:e,Action:t,event:"genericEvent"};i&&(o.Label=i),n&&(o.Wert=n),a&&(o.clickLocation=a),dataLayer.push(o)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,i){return t&&v(e.prototype,t),i&&v(e,i),e}function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var k=function(){function e(){b(this,e),g(this,"map",void 0),g(this,"marker",void 0),g(this,"type",void 0),g(this,"offset",0),g(this,"hasPopup",!0),g(this,"elementId","")}return y(e,[{key:"setType",value:function(e){return this.type=e,this}},{key:"setOffset",value:function(e){return this.offset=e,this}},{key:"setPopup",value:function(e){return this.hasPopup=e,this}},{key:"build",value:function(e,i){var n=this;this.map=e,this.marker=i;var a=HTMLElement;a=document.createElement("div");var o=HTMLElement;"marker"==this.type?this.elementId=this.type+this.marker.properties.uid:"searchPin"==this.type?this.elementId=this.type+this.marker.id:"reverseSearchMarker"==this.type?this.elementId=this.type:(this.marker.properties.uid&&(a.id=this.type+this.marker.properties.uid),this.elementId=this.type+this.marker.properties.id),$("#"+this.elementId).length&&$("#"+this.elementId).remove(),this.marker.properties.newStyle?(a.className="customPin",(o=document.createElement("div")).className="hbdpin "+this.type,o.id=this.elementId,"routePin"==this.type&&o.id.indexOf("waypoint")>=0&&(o.className+=" routeWaypoint"),this.marker.properties.tag&&o.setAttribute("data-before",this.marker.properties.tag)):this.marker.properties["marker-symbol"]?((o=document.createElement("div")).id=this.elementId,o.className+=this.type+" pin "+this.marker.properties["marker-symbol"],this.marker.properties["marker-color"]?o.style.backgroundImage="url('https://a.tiles.mapbox.com/v4/marker/pin-m-"+this.marker.properties["marker-symbol"]+this.marker.properties["marker-color"].replace("#","+")+".png?access_token="+this.map.key+"')":o.style.backgroundImage="url('https://a.tiles.mapbox.com/v4/marker/pin-m-"+this.marker.properties["marker-symbol"]+".png?access_token="+this.map.key+"')"):this.marker.properties.icon?((o=document.createElement("img")).id=this.elementId,o.className+=this.type+" image "+this.marker.properties.category,o.src=i.properties.icon.iconUrl):((o=document.createElement("img")).id=this.elementId,o.setAttribute("src","/images/mapPins/reverseSearch.svg"),o.className=this.type+" hbdpin fallback",a.style.zIndex=101),o.setAttribute("data-has-popup",this.hasPopup),a.appendChild(o);var r=new mapboxgl.Marker(a).setLngLat(i.geometry.coordinates);if(this.hasPopup){var s=new mapboxgl.Popup({offset:this.offset,anchor:"top"}).setDOMContent((new C).setType(this.type).build(this.map,this.marker)).on("open",(function(e){n.map.currentPopup=s;var i=e.target._lngLat,a=0-$(e.target._container).outerHeight()/3;$("#detailBox.mapview").length||$("#searchresult.mapview").length||$("body.site_RP").length||($(".map-toggle-on").click(),setTimeout((function(){n.map.flyMeTo(i,[0,a])}),t.basic.animateDuration)),f("map pin","click",n.marker.properties.id)})).on("close",(function(e){}));r.setPopup(s)}return r.addTo(this.map.map),r}}]),e}(),C=function(){function e(){b(this,e),g(this,"map",void 0),g(this,"marker",void 0),g(this,"type",void 0)}return y(e,[{key:"setType",value:function(e){return this.type=e,this}},{key:"build",value:function(e,t){var i=this;this.map=e,this.marker=t;var n=document.createElement("div");n.className="popupContentNew";var a=this.marker.properties;if($.isEmptyObject(a)){var o=document.createElement("div"),r=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div"),c=document.createElement("div");o.className=r.className="row",s.className="col-22",l.className=c.className="col-12 groupPadding";var u=document.createElement("img");u.setAttribute("src","/images/mapPins/pin.svg");var p=document.createElement("div");p.innerHTML="<p><b>"+t.place_name.replace(", Österreich","")+"</b></p><p>"+t.center[1]+", "+t.center[0]+"</p>";var d=document.createElement("button");d.className="btn btn-md btn-hbd btn-light-yellow fullWidth setRoutePin",d.setAttribute("type","button"),d.setAttribute("data-poi-action","origin"),d.innerHTML="Route von hier",d.addEventListener("click",(function(){i.map.setPin("origin",t),i.map.planRoute.setRouteItem("origin",t),i.map.checkRouteComplete()}));var h=document.createElement("button");h.className="btn btn-md btn-hbd btn-light-yellow fullWidth setRoutePin",h.setAttribute("type","button"),h.setAttribute("data-poi-action","destination"),h.innerHTML="Route hierher",h.addEventListener("click",(function(){i.map.setPin("destination",t),i.map.planRoute.setRouteItem("destination",t),i.map.checkRouteComplete()})),o.appendChild(s).appendChild(u),o.appendChild(s).appendChild(p),n.appendChild(o),r.appendChild(l).appendChild(d),r.appendChild(c).appendChild(h),n.appendChild(r)}else{var m;if(a.iframe_width&&n.setAttribute("style","width: "+a.iframe_width+"px;"),(m=document.createElement("span")).setAttribute("class","close"),m.innerHTML='<i class="icon-close" />',m.addEventListener("click",(function(){$(".mapboxgl-popup-close-button").click()})),n.appendChild(m),a.title){var b,v=document.createElement("div");v.setAttribute("class","headline"),a.hasOwnProperty("link")&&""!=a.link?((b=document.createElement("a")).setAttribute("href",a.link),b.setAttribute("target","_blank"),b.setAttribute("title","Öffnet neues Fenster")):b=document.createElement("span"),b.innerHTML="<h3>"+a.title+"</h3>",v.appendChild(b),n.appendChild(v)}if(a.category){var y=document.createElement("p");y.setAttribute("class","category"),y.innerHTML=a.category,n.appendChild(y)}if(a.hasOwnProperty("ratingstotal")&&a.ratingstotal>0){var g=Math.round(a.ratingsavg),k=5-g,C=document.createElement("div");C.setAttribute("class","company-rating");for(var w="",L=0;L<g;L++)w+='<i class="icon icon-star active"></i>';for(var _=0;_<k;_++)w+='<i class="icon icon-star"></i>';w+='<b class="rating-average pl-2">'+a.ratingsavg.toFixed(1).replace(".",",")+'</b><span class="rating-total">&nbsp;('+a.ratingstotal+")</span>",C.innerHTML=w,n.appendChild(C)}if(a.iframe_width&&a.iframe_height&&a.iframe_url){var P=document.createElement("iframe");P.setAttribute("style","width:"+a.iframe_width+"px;height:"+a.iframe_height+"px;border:0)"),P.setAttribute("src",a.iframe_url),P.setAttribute("allowfullscreen",""),n.appendChild(P)}if(a.image){var x=document.createElement("img");x.setAttribute("src",a.image),x.setAttribute("alt",""),x.innerHTML="<p>"+a.address+"</p>",n.appendChild(x)}if(a.hasOwnProperty("address")){var E=document.createElement("div");E.setAttribute("class","address"),E.innerHTML="<p>"+a.address+"</p>",n.appendChild(E)}if(a.hasOwnProperty("text")){var T=document.createElement("p");T.innerHTML=a.text,n.appendChild(T)}if(a.businessHoursSet&&"true"==a.businessHoursSet&&(a.businessHoursStatus||a.businessHoursText)){var M=document.createElement("div");M.setAttribute("class","openingHours status "+a.businessHoursClass),M.setAttribute("title","Öffnungszeiten heute");var A=document.createElement("i");if(A.setAttribute("class","icon-clock ml-2"),M.appendChild(A),a.businessHoursStatus){var N=document.createElement("span");N.setAttribute("class","status mx-2"),N.appendChild(document.createTextNode(a.businessHoursStatus+" ")),M.appendChild(N)}if(a.businessHoursText){var H=document.createElement("span");H.setAttribute("class","slot"),H.appendChild(document.createTextNode(a.businessHoursText)),M.appendChild(H)}n.appendChild(M)}if(a.hasOwnProperty("source")||a.hasOwnProperty("sourceimg")){var O,S=document.createElement("p");S.setAttribute("class","text-muted small"),O=a.hasOwnProperty("sourceimg")?'<img src="'+a.sourceimg+'" alt="'+a.source+'"/>':a.source,a.hasOwnProperty("sourcelink")&&""!=a.sourcelink?S.innerHTML='<a href="'+a.sourcelink+'" rel="noopener" target="_blank" title="Öffnet neues Fenster">'+O+"</a>":S.innerHTML=O,n.appendChild(S)}if(a.hasOwnProperty("to")||a.hasOwnProperty("phonenumber")){var I,R=document.createElement("div");if(R.setAttribute("class","functions"),a.hasOwnProperty("sid")?I="YP:"+a.sid:a.hasOwnProperty("pid")&&(I="WP:"+a.pid),a.hasOwnProperty("to")){var z=document.createElement("a");z.setAttribute("class","btn btn-hbd gray"),z.setAttribute("href",a.to),z.setAttribute("target","_top"),z.innerHTML="Route planen",z.addEventListener("click",(function(){f("get direction"+a.pageType,"click",I,"inmap")})),R.appendChild(z)}if(a.hasOwnProperty("phonenumber")){var j=document.createElement("div");j.setAttribute("class","buttonPhone");var F=document.createElement("a");F.setAttribute("class","d-flex d-md-none btn-hbd yellow hasIcon"),F.setAttribute("href","tel:"+a.phonenumber),F.setAttribute("target","_top"),F.innerHTML='<i class="icon-phone"></i>Anrufen',F.addEventListener("click",(function(){f("Telefonnummer_result","call",I,"inmap")}));var B=document.createElement("a");B.setAttribute("class","d-none d-md-block btn btn-hbd yellow fullWidth callPhone hidden ellipsis"),B.setAttribute("href","tel:"+a.phonenumber),B.setAttribute("target","_top"),B.innerHTML=a.phonenumber,B.addEventListener("click",(function(){f("Telefonnummer_result","call",I,"inmap")}));var Z=document.createElement("button");Z.setAttribute("class","d-none d-md-flex btn btn-hbd yellow hasIcon fullWidth showPhone switch"),Z.innerHTML='<i class="icon-phone"></i>Nr. anzeigen',Z.addEventListener("click",(function(){f("Telefonnummer_result","show",I,"inmap"),this.previousSibling.classList.remove("hidden"),this.parentNode.removeChild(this)})),j.appendChild(F),j.appendChild(B),j.appendChild(Z),R.appendChild(j)}n.appendChild(R)}}return n}}]),e}();function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t,i){return t&&L(e.prototype,t),i&&L(e,i),e}function P(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var x=function(){function e(t){w(this,e),P(this,"_map",void 0),P(this,"_container",void 0),P(this,"locationHTMLnoText",'<button class="mapboxgl-ctrl-icon mapboxgl-ctrl-overlay" type="button" data-toggle="modal" data-target="#overlayMapModal" aria-label="Toggle bigger view"></button>'),P(this,"locationHTMLwithText",'<button class="mapboxgl-ctrl-icon mapbox-ctrl-text mapboxgl-ctrl-overlay" type="button" data-toggle="modal" data-target="#overlayMapModal" aria-label="Toggle bigger view"><span class="d-none d-md-block medium">Karte vergrößern</span></button>'),P(this,"tracking",""),this.tracking=t}return _(e,[{key:"onAdd",value:function(e){var t=this;return this._map=e,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl mapboxgl-ctrl-group toGroup d-block",$(this._map._container).data("overlay-text")?this._container.innerHTML=this.locationHTMLwithText:this._container.innerHTML=this.locationHTMLnoText,this._container.addEventListener("click",(function(){f("show map","click",t.tracking)})),this._container}},{key:"onRemove",value:function(){this._container.parentNode.removeChild(this._container),this._map=void 0}}]),e}(),E=function(){function e(){w(this,e),P(this,"_map",void 0),P(this,"_container",void 0),P(this,"locationHTML",'<button class="mapboxgl-ctrl-icon mapbox-ctrl-text mapboxgl-ctrl-close" type="button" class="close" data-dismiss="modal" aria-label="Close"><span class="d-none d-md-block medium">Karte schließen</span></button>')}return _(e,[{key:"onAdd",value:function(e){return this._map=e,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl mapboxgl-ctrl-group toGroup d-block",this._container.innerHTML=this.locationHTML,this._container.addEventListener("click",(function(){var e=document.querySelector(".mapboxgl-ctrl-shrink");e&&e.click()})),this._container}},{key:"onRemove",value:function(){this._container.parentNode.removeChild(this._container),this._map=void 0}}]),e}();function T(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var A=function(){function n(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),M(this,"map",void 0),M(this,"key",void 0),M(this,"coordinates",[]),M(this,"type",void 0),M(this,"controls",{zoom:"",location:"",poiview:"",styles:"",overlay:"",fullsize:"",popup:"false",tracking:""}),M(this,"zoom",void 0),M(this,"style",t.basic.style),M(this,"poiconfig",void 0),M(this,"features",void 0),M(this,"featuresForeignAdvertiser",void 0),M(this,"featuresNoFitBounds",void 0),M(this,"padding",{top:0,right:0,bottom:0,left:0}),M(this,"additionalLayers",[]),M(this,"currentPopup",{}),M(this,"myLocation",void 0),M(this,"geolocation",void 0),M(this,"changeStyles",void 0),M(this,"changePOIview",void 0),M(this,"findPois",void 0)}return a=n,(r=[{key:"setKey",value:function(e){return this.key=e,this}},{key:"setType",value:function(e){return this.type=e,this}},{key:"setControls",value:function(e){return this.controls=e,this}},{key:"setZoom",value:function(e){return this.zoom=e,this}},{key:"setStyle",value:function(e){switch(e){case"Luftbilder":this.style=t.layers.filter((function(e){return"Luftbilder"===e.name}))[0].style;break;case"Hybrid":this.style=t.layers.filter((function(e){return"Hybrid"===e.name}))[0].style;break;default:this.style=t.basic.style}return this}},{key:"setPoiconfig",value:function(e){return this.poiconfig=e,this}},{key:"setFeatures",value:function(e){return this.features=e,this}},{key:"setFeaturesAdditional",value:function(e,t){return this.featuresForeignAdvertiser=t,this.featuresNoFitBounds=e,0==this.features.features.length&&(this.features=t),this}},{key:"build",value:function(){var e=this;this.padding=this.type?t[this.type].padding:t.basic.padding,this.setCoordinates(this.features),mapboxgl.accessToken=this.key,this.map=new mapboxgl.Map({style:this.style,defaultLanguage:"name_de",dragRotate:t.basic.dragRotate,dragPan:t.basic.dragPan,touchZoomRotate:t.basic.touchZoomRotate,trackResize:t.basic.trackResize,attributionControl:t.basic.attributionControl,maxZoom:t.basic.maxZoom,container:t[this.type].container,center:this.getCenter(),zoom:this.getInitialZoom(),interactive:t[this.type].interactive,scrollZoom:t[this.type].scrollZoom}),this.map.touchZoomRotate.disableRotation(),this.map.once("load",(function(t){e.getPOIs(e.type)})),this.map.on("moveend",(function(t){e.getPOIs(e.type)})),this.map.on("style.load",(function(){!function t(){e.map.isStyleLoaded()?e.additionalLayers.forEach((function(t){void 0===e.map.getLayer(t.name)&&(e.map.addSource(t.name,t.source),e.map.addLayer(t.layer))})):setTimeout(t,200)}()})),this.adjustZoom(),this.addControls();var i=this.features.features;return i.reverse(),i.forEach((function(t){t.properties.newStyle=!0,(new k).setType(t.properties.highlight?"companyPinHighlight":"companyPin").setPopup(e.controls.popup).build(e,t)})),this.featuresForeignAdvertiser&&((i=this.featuresForeignAdvertiser.features).reverse(),i.forEach((function(t){t.properties.newStyle=!0,(new k).setType("companyPin").setPopup(e.controls.popup).build(e,t)}))),this.featuresNoFitBounds&&((i=this.featuresNoFitBounds.features).reverse(),i.forEach((function(t){t.properties.newStyle=!0,(new k).setType("companyPinStar").setPopup(e.controls.popup).build(e,t)}))),this}},{key:"addControls",value:function(){var e=new mapboxgl.AttributionControl,t=new MapboxLanguage({defaultLanguage:"de"});if(this.controls.overlay){var n=new x(this.controls.tracking);this.map.addControl(n,i[this.controls.overlay])}if(this.controls.overlayclose){var a=new E;this.map.addControl(a,i[this.controls.overlayclose])}if(this.controls.fullsize){var r=new mapboxgl.FullscreenControl;this.map.addControl(r,i[this.controls.fullsize])}if(this.controls.styles&&(this.changeStyles=new l,this.map.addControl(this.changeStyles,i[this.controls.styles])),this.controls.poiview&&(this.changePOIview=new o(this),this.map.addControl(this.changePOIview,i[this.controls.poiview])),this.controls.location&&(this.geolocation=new m(this),this.map.addControl(this.geolocation,i[this.controls.location])),this.controls.zoom){var s=new mapboxgl.NavigationControl({showCompass:!1});this.map.addControl(s,i[this.controls.zoom])}this.map.addControl(e,"bottom-left"),this.map.addControl(t),$("#layers input").removeAttr("checked"),$('#layers input[data-style="'+this.style+'"]').attr("checked","")}},{key:"checkPredefinedPoints",value:function(){return!1}},{key:"setCoordinates",value:function(e){var i=this;this.coordinates=[],e.features.forEach((function(e){i.coordinates.push(e.geometry.coordinates)})),this.coordinates.length||(this.coordinates=t.boundsOfAT)}},{key:"setPin",value:function(e,t){var i="";"location"!==e&&(i=e),t.properties={},t.properties.id=i,t.properties.newStyle=!0,this.features.features.push(t),this.setCoordinates(this.features),(new k).setType(""==i?"locationPin":"routePin").setPopup(!1).build(this,t)}},{key:"getInitialZoom",value:function(){return this.zoom&&0!==this.zoom?this.zoom-1:t[this.type].zoom}},{key:"getCenter",value:function(){var e=[],t=[];return this.coordinates.forEach((function(i){e.push(i[0]),t.push(i[1])})),[Math.min.apply(Math,e)+(Math.max.apply(Math,e)-Math.min.apply(Math,e))/2,Math.min.apply(Math,t)+(Math.max.apply(Math,t)-Math.min.apply(Math,t))/2]}},{key:"getBounds",value:function(){return this.coordinates.reduce((function(e,t){return e.extend(t)}),new mapboxgl.LngLatBounds(this.coordinates[0],this.coordinates[0]))}},{key:"centerMap",value:function(e){e?this.map.setCenter(e):this.map.setCenter(this.getCenter())}},{key:"flyMeTo",value:function(e,i,n,a){e||(e=this.getCenter()),i||(i=[0,0]),n||(n=t.basic.animateSpeed),a?this.map.flyTo({center:e,offset:i,speed:n,zoom:a}):this.map.flyTo({center:e,offset:i,speed:n})}},{key:"adjustZoom",value:function(){this.coordinates.length>1&&this.map.fitBounds(this.getBounds(),{padding:this.padding,duration:t.basic.animateDuration})}},{key:"resize",value:function(){if(e.matches){var t=0,i=0;$("#mobileRouteTop .content").is(":visible")&&(t+=$("#mobileRouteTop .content").height()),$("#mobileRouteBottom .content").is(":visible")&&(i+=$("#mobileRouteBottom").height()),$("#mobileCompanyInfo").length&&(i+=$("#mobileCompanyInfo").height()),$("#map").css("top",t),$("#map").css("bottom",i)}this.map.resize()}},{key:"getPOIs",value:function(e){var i=this;$("#"+t[e].container+" .poi").addClass("old");var n,a={callback:"geojson",minx:this.map.getBounds()._sw.lng,miny:this.map.getBounds()._sw.lat,maxx:this.map.getBounds()._ne.lng,maxy:this.map.getBounds()._ne.lat,z:Math.round(this.map.getZoom()+1),type:""};a.type=(n=[],i.poiconfig.forEach((function(e){e.defaultsel&&n.push(e.id)})),n).join(","),""!==a.type&&(this.findPois&&this.findPois.readyState<4&&this.findPois.abort(),this.findPois=$.ajax({type:"GET",data:a,url:"/servlet/findPOIs",context:this,dataType:"JSON",success:function(e){e.geojson.features.forEach((function(e){(new k).setType("poi").build(i,e)}))},complete:function(){$("#"+t[e].container+" .poi.old").remove()}}))}}])&&T(a.prototype,r),s&&T(a,s),n;var a,r,s}(),N=$('.result-item[clickable="true"]');$((function(){var e=$("#map").css("margin-top");window.document.addEventListener("MSFullscreenChange",(function(){"0px"==$("#map").css("margin-top")?$("#map").css("margin-top",e):$("#map").css("margin-top","0px")})),$("body");var t=$("#mainMap"),i=$("#overlayMap");if(t.length){if(void 0===n)var n={features:[]};if(void 0===a)var a={features:[]};var o;(new A).setKey(mapboxGLKey).setType("resultList").setControls(t.data()).setZoom(0).setPoiconfig(poiconfig).setFeatures(features).setFeaturesAdditional(n,a).build(),$("#showMapOverlay").on("click",(function(){$(".mapboxgl-ctrl-overlay").click()})),"true"==$("#searchresult").attr("showMap")&&$(".mapboxgl-ctrl-overlay").click(),"true"==$("#detailBox").attr("showMap")&&$(".mapboxgl-ctrl-overlay").click(),N.on("mouseenter mouseleave",(function(e){var t;t=$(this).data("adv-sponsor")?"#companyPinStar"+$(this).data("uid"):"#companyPin"+$(this).data("uid"),"mouseenter"===e.type?$(t).addClass("toFront"):$(t).removeClass("toFront")})),$("#overlayMapModal").on("shown.bs.modal",(function(){o?o.centerMap(features.features[0].geometry.coordinates):o=(new A).setKey(mapboxGLKey).setType("overlay").setControls(i.data()).setZoom(0).setPoiconfig(poiconfig).setFeatures(features).setFeaturesAdditional(n,a).build()}))}}))}();
//# sourceMappingURL=map.js.map